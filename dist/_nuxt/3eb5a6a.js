(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{459:function(e,t,n){"use strict";n(23);t.a={required:function(e){return function(t){return t&&t.length>0||"You must input a ".concat(e)}},minLength:function(e,t){return function(n){return n&&n.length>=t||"".concat(e," must be at least ").concat(t," characters")}},maxLength:function(e,t){return function(n){return n&&n.length<=t||"".concat(e," must be less than ").concat(t," characters")}},emailFormat:function(){var e=/^\w+([/.-]?\w+)*@\w+([/.-]?\w+)*(\.\w{2,24})+$/;return function(t){return t&&e.test(t)||"Must be a valid email"}},numberFormat:function(){var e=/^[/+]?[(]?[0-9]{3}[)]?[-\s/.]?[0-9]{3}[-\s/.]?[0-9]{4,6}$/im;return function(t){return t&&e.test(t)||"Must be a valid phone number"}}}},538:function(e,t,n){"use strict";n.r(t);n(9),n(6),n(8),n(11),n(12);var r=n(2),o=(n(24),n(30),n(51),n(20),n(72),n(7),n(39),n(79)),c=n.n(o),l=n(459);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var h={props:["submitForm","buttonText","hasName"],data:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({ceo:!1,selectCity:"",cities:[],search:"",expanded:[],singleExpand:!1,dialog:!1,dialogDelete:!1,headers:[{text:"Name",align:"start",value:"name",groupable:!1},{text:"Category",value:"category.name",align:"right"},{text:"Price (incl. VAT)",value:"priceInclTax",align:"right"},{text:"VAT %",value:"vat",align:"right"},{text:"Price (excl. VAT)",value:"priceExclTax",align:"right"},{text:"Actions",value:"actions",sortable:!1}],id_category:-1,formdata:null,valid:!0,alergen:{id:"",name:""},products:[],allergenList:[],categoryList:[],ids:[],allergens_from_edit:[],allergen_object_from_creation:[],allergens_from_creation:[],allergens_with_select:[],ingredient:{id:"",name:"",quantity:0,unit:""},product:{id:"",name:"",allergens:[],category:{id:"",name:""},recipe:{id:"",description:"",ingredients:[]},priceInclTax:null,vat:null},productInfo:{id:"",name:"",allergens:[],selectCategory:"",priceInclTax:null,vat:null},defaultProduct:{id:"",name:"",allergens:[],category:{id:"",name:""},recipe:{id:"",description:"",ingredients:[]},priceInclTax:null,vat:null},managment:!1,checkbox:!1,editedIndex:-1},l.a)},computed:{formTitle:function(){return"Edit Item"}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},mounted:function(){this.getAllProducts(),this.getCategories(),this.getAllergens(),this.getCities(),"CEO"===this.$auth.user.role.name&&(this.ceo=!0,this.managment=!0),"ADMIN"!==this.$auth.user.role.name&&"DEPARTMENT"!==this.$auth.user.role.name||(this.managment=!0)},methods:{getCities:function(){var e=this;c.a.get("http://212.227.210.204:8765/cities",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){e.cities=t.data})).catch((function(e){window.alert("An error occurred. Please try again!");var t=e.response;console.log(JSON.stringify(t.data.errors))}))},getAllProducts:function(){var e=this;c.a.get("http://212.227.210.204:8765/products",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){e.products=t.data})).catch((function(e){return console.log(e)}))},getCategories:function(){var e=this;c.a.get("http://212.227.210.204:8765/categories",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){e.categoryList=t.data})).catch((function(e){window.alert("An error occurred. Please try again!");var t=e.response;console.log(t)}))},getAllergens:function(){var e=this;c.a.get("http://212.227.210.204:8765/allergens",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){e.allergenList=t.data})).catch((function(e){window.alert("An error occurred. Please try again!");var t=e.response;console.log(t)}))},findIDAllergensCreation:function(){var e=this;this.productInfo.allergens=this.productInfo.allergens.toString().split(","),this.allergenList.forEach((function(element){e.productInfo.allergens.forEach((function(t){element.name===t&&e.ids.push(element.id)}))}))},findIDCategory:function(){var e=this;this.categoryList.forEach((function(element){element.name===e.productInfo.selectCategory&&(e.id_category=element.id)})),-1===this.id_category&&console.log("no existing id")},addProduct:function(){var e=this;this.findIDAllergensCreation(),this.findIDCategory(),this.formdata=new FormData,this.formdata.append("name",this.productInfo.name),this.formdata.append("allergens",this.ids),this.formdata.append("cat_id",this.id_category),this.formdata.append("recipe_id",""),this.formdata.append("price",this.productInfo.priceInclTax),this.formdata.append("vat",this.productInfo.vat);var t=0;!0===this.ceo?(this.cities.forEach((function(n){n.name===e.selectCity&&(t=n.id)})),this.formdata.append("city",t)):this.formdata.append("city",this.$auth.user.employee.department.city.id),c()({url:"http://212.227.210.204:8765/department/create_product",method:"POST",data:this.formdata,headers:{Authorization:this.$auth.getToken("local"),"Content-Type":"multipart/form-data"}}).then((function(e){})).catch((function(e){window.alert("An error occurred. Please try again!");var t=e.response;console.log(JSON.stringify(t))})),window.location.reload()},findIDAllergens:function(){var e=this;this.productInfo.allergens=this.productInfo.allergens.toString().split(","),this.allergenList.forEach((function(element){e.productInfo.allergens.forEach((function(t){element.name===t&&e.ids.push(element.id)}))}))},getItemById:function(e){var t=this;c.a.get("http://212.227.210.204:8765/product/"+e.id,{headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){t.product=e.data})).catch((function(e){window.alert("An error occurred. Please try again!");var t=e.response;console.log(t),console.log(JSON.stringify(t.data.errors))}))},editProduct:function(e){var t=this;this.getAllergens(),this.allergens_with_select=[],this.allergenList.forEach((function(element){t.allergens_with_select.push(element)})),this.allergens_with_select.forEach((function(e){e.selected=!1}));var n=e.allergens.map((function(e){return e.name}));this.allergens_with_select.forEach((function(e){n.forEach((function(element){e.name===element&&(e.selected=!0)}))}));var r=[];this.allergens_with_select.forEach((function(element){!0===element.selected&&(t.alergen.id=element.id,t.alergen.name=element.name,r.push(t.alergen))})),e.allergens=r,this.product=e,this.selectCity=e.city.name,this.dialog=!0},save:function(){var e=this;this.ids=[],this.allergens_with_select.forEach((function(t){t.selected&&e.ids.push(t.id)})),this.categoryList.forEach((function(element){element.name===e.product.category.name&&(e.product.category.id=element.id,console.log("changed"))})),this.formdata=new FormData,this.formdata.append("id",this.product.id),this.formdata.append("name",this.product.name),this.formdata.append("allergens",this.ids),this.formdata.append("cat_id",this.product.category.id),null!==this.product.recipe?this.formdata.append("recipe_id",this.product.recipe.id):this.formdata.append("recipe_id",""),this.formdata.append("price",this.product.priceInclTax),this.formdata.append("vat",this.product.vat);var t=0;!0===this.ceo?(this.cities.forEach((function(n){n.name===e.selectCity&&(t=n.id)})),this.formdata.append("city",t)):this.formdata.append("city",this.$auth.user.employee.department.city.id),c()({url:"http://212.227.210.204:8765/department/update_product",method:"PUT",headers:{Authorization:this.$auth.getToken("local"),"Content-Type":"multipart/form-data"},data:this.formdata}).then((function(e){})).catch((function(e){console.log("in catch"),window.alert("An error occurred. Please try again!");var t=e.response;console.log(JSON.stringify(t.data.errors))})),this.products=this.getAllProducts(),this.close(),window.location.reload()},removeProduct:function(e){this.product=Object.assign(this.product,e),this.dialogDelete=!0},deleteItemConfirm:function(){c()({url:"http://212.227.210.204:8765/department/delete_product/"+this.product.id.toString(),method:"DELETE",headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){})).catch((function(e){console.log("in catch"),window.alert("An error occurred. Please try again!");var t=e.response;console.log(JSON.stringify(t.data.errors))})),this.closeDelete(),this.products=this.getAllProducts()},unlinkRecipe:function(e){c()({url:"http://212.227.210.204:8765/department/remove_recipe_from_product/"+e,method:"PUT",headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){})).catch((function(e){console.log("in catch"),window.alert("An error occurred. Please try again!");var t=e.response;console.log(JSON.stringify(t.data.errors))})),window.location.reload()},close:function(){this.dialog=!1,this.resetForm()},closeDelete:function(){var e=this;this.dialogDelete=!1,this.$nextTick((function(){e.productInfo=Object.assign({},e.defaultProduct),e.editedIndex=-1})),window.location.reload()},resetForm:function(){this.$refs.form.reset()},exportpdf:function(){}}},m=n(78),f=n(96),v=n.n(f),_=n(231),y=n(455),x=n(454),I=n(474),k=n(468),$=n(453),w=n(612),T=n(475),C=n(195),A=n(460),P=n(155),V=n(196),O=n(131),D=n(70),E=n(202),L=n(467),S=n(57),j=n(451),N=n(86),F=n(64),z=n(208),component=Object(m.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.products,search:e.search,"single-expand":e.singleExpand,expanded:e.expanded,"item-key":"name","show-expand":"","sort-by":"name"},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[e._v(e._s(e.$t("products")))]),e._v(" "),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),e._v(" "),n("v-spacer"),e._v(" "),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:e.$t("search"),"single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.$t("editItem")))])]),e._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:e.$t("productName")},model:{value:e.product.name,callback:function(t){e.$set(e.product,"name",t)},expression:"product.name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:e.$t("priceInclVAT")},model:{value:e.product.priceInclTax,callback:function(t){e.$set(e.product,"priceInclTax",t)},expression:"product.priceInclTax"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-select",{ref:"category",attrs:{items:e.categoryList.map((function(e){return e.name})),rules:[function(e){return!!e||"Item is required"}],label:e.$t("categoryName"),required:""},model:{value:e.product.category.name,callback:function(t){e.$set(e.product.category,"name",t)},expression:"product.category.name"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-menu",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-btn",e._g(e._b({attrs:{color:"primary",dark:""}},"v-btn",o,!1),r),[e._v("\n                          "+e._s(e.$t("allergens"))+"\n                        ")])]}}])},[e._v(" "),n("v-list",e._l(e.allergens_with_select,(function(t){return n("v-list-item",{key:t.id},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"allergen.selected"}],attrs:{type:"checkbox"},domProps:{checked:t.selected,checked:Array.isArray(t.selected)?e._i(t.selected,null)>-1:t.selected},on:{change:function(n){var r=t.selected,o=n.target,c=!!o.checked;if(Array.isArray(r)){var l=e._i(r,null);o.checked?l<0&&e.$set(t,"selected",r.concat([null])):l>-1&&e.$set(t,"selected",r.slice(0,l).concat(r.slice(l+1)))}else e.$set(t,"selected",c)}}}),e._v(" "+e._s(t.name)+"\n                        ")])})),1)],1)],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:e.$t("VAT")},model:{value:e.product.vat,callback:function(t){e.$set(e.product,"vat",t)},expression:"product.vat"}})],1),e._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[e.ceo?n("v-select",{ref:"city",attrs:{items:e.cities.map((function(e){return e.name})),rules:[function(e){return!!e||"Item is required"}],label:e.$t("cityChoice"),required:""},model:{value:e.selectCity,callback:function(t){e.selectCity=t},expression:"selectCity"}}):e._e()],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("\n                "+e._s(e.$t("cancel"))+"\n              ")]),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("\n                "+e._s(e.$t("save"))+"\n              ")])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[e._v("\n              "+e._s(e.$t("areYouSureYouWantToDeleteThisItem"))+"\n            ")]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("\n                "+e._s(e.$t("cancel"))+"\n              ")]),e._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("\n                OK\n              ")]),e._v(" "),n("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var r=t.item;return[e.managment?n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editProduct(r)}}},[e._v("\n        mdi-pencil\n      ")]):e._e(),e._v(" "),e.managment?n("v-icon",{attrs:{small:""},on:{click:function(t){return e.removeProduct(r)}}},[e._v("\n        mdi-delete\n      ")]):e._e()]}},{key:"expanded-item",fn:function(t){var r=t.item;return[n("td",{attrs:{colspan:e.headers.length}},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(e.$t("moreInfo")))]),e._v(" "),n("v-list-item-subtitle",[e._v("\n              "+e._s(e.$t("allergens"))+": "+e._s(r.allergens.map((function(a){return a.name})))+"\n            ")]),e._v(" "),r.recipe?n("v-list",[n("v-btn",{staticClass:"primary",attrs:{text:"",to:"/recipe/"+r.recipe.id}},[e._v("\n                "+e._s(e.$t("recipe"))+"\n              ")]),e._v(" "),e.managment?n("v-btn",{staticClass:"secondary",attrs:{text:""},on:{click:function(t){return e.unlinkRecipe(r.id)}}},[e._v("\n                "+e._s(e.$t("deleteRecipeFromProduct"))+"\n              ")]):e._e()],1):n("v-list",[n("v-text",[e._v("\n                "+e._s(e.$t("noRecipesCreatedForThisProduct"))+"\n              ")]),e._v(" "),e.managment?n("v-btn",{staticClass:"primary",attrs:{text:"",to:"/createRecipe/"+r.id}},[e._v("\n                "+e._s(e.$t("createRecipe"))+"\n              ")]):e._e()],1)],1)],1)],1)]}}],null,!0)}),e._v(" "),n("v-toolbar",{attrs:{color:"transparent",dark:""}},[e.managment?n("v-toolbar-title",[e._v("\n      "+e._s(e.$t("createNewProduct"))+"\n    ")]):e._e(),e._v(" "),n("v-spacer")],1),e._v(" "),e.managment?n("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-text-field",{ref:"name",attrs:{label:e.$t("name"),rules:[e.required("Name")]},model:{value:e.productInfo.name,callback:function(t){e.$set(e.productInfo,"name",t)},expression:"productInfo.name"}}),e._v(" "),n("v-select",{ref:"category",attrs:{items:e.categoryList.map((function(e){return e.name})),rules:[function(e){return!!e||"Category is required"}],label:e.$t("category"),required:""},model:{value:e.productInfo.selectCategory,callback:function(t){e.$set(e.productInfo,"selectCategory",t)},expression:"productInfo.selectCategory"}}),e._v(" "),n("v-select",{ref:"allergens",attrs:{items:e.allergenList.map((function(e){return e.name})),label:e.$t("allergens"),multiple:""},model:{value:e.productInfo.allergens,callback:function(t){e.$set(e.productInfo,"allergens",t)},expression:"productInfo.allergens"}}),e._v(" "),n("v-text-field",{ref:"price",attrs:{label:e.$t("priceInclVAT"),rules:[e.required("price")]},model:{value:e.productInfo.priceInclTax,callback:function(t){e.$set(e.productInfo,"priceInclTax",t)},expression:"productInfo.priceInclTax"}}),e._v(" "),n("v-text-field",{attrs:{label:e.$t("VAT"),rules:[e.required("VAT")]},model:{value:e.productInfo.vat,callback:function(t){e.$set(e.productInfo,"vat",t)},expression:"productInfo.vat"}}),e._v(" "),e.ceo?n("v-select",{ref:"city",attrs:{items:e.cities.map((function(e){return e.name})),rules:[function(e){return!!e||"Item is required"}],label:e.$t("cityChoice"),required:""},model:{value:e.selectCity,callback:function(t){e.selectCity=t},expression:"selectCity"}}):e._e(),e._v(" "),n("v-checkbox",{attrs:{rules:[function(e){return!!e||"You must agree to continue!"}],label:e.$t("isInformationCorrect"),required:""},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}}),e._v(" "),n("v-btn",{attrs:{color:"success",disabled:!e.valid},on:{click:function(t){return e.addProduct()}}},[e._v("\n      "+e._s(e.$t("submit"))+" "+e._s(e.buttonText)+"\n    ")]),e._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:function(t){return e.resetForm()}}},[e._v("\n      "+e._s(e.$t("resetForm"))+" "+e._s(e.buttonText)+"\n    ")])],1):e._e()],1)}),[],!1,null,"c92a9090",null);t.default=component.exports;v()(component,{VBtn:_.a,VCard:y.a,VCardActions:x.a,VCardText:x.b,VCardTitle:x.c,VCheckbox:I.a,VCol:k.a,VContainer:$.a,VDataTable:w.a,VDialog:T.a,VDivider:C.a,VForm:A.a,VIcon:P.a,VList:V.a,VListItem:O.a,VListItemContent:D.a,VListItemSubtitle:D.b,VListItemTitle:D.c,VMenu:E.a,VRow:L.a,VSelect:S.a,VSpacer:j.a,VTextField:N.a,VToolbar:F.a,VToolbarTitle:z.a})}}]);