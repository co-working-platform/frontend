(window.webpackJsonp=window.webpackJsonp||[]).push([[56,31],{459:function(t,e,n){"use strict";n(23);e.a={required:function(t){return function(e){return e&&e.length>0||"You must input a ".concat(t)}},minLength:function(t,e){return function(n){return n&&n.length>=e||"".concat(t," must be at least ").concat(e," characters")}},maxLength:function(t,e){return function(n){return n&&n.length<=e||"".concat(t," must be less than ").concat(e," characters")}},emailFormat:function(){var t=/^\w+([/.-]?\w+)*@\w+([/.-]?\w+)*(\.\w{2,24})+$/;return function(e){return e&&t.test(e)||"Must be a valid email"}},numberFormat:function(){var t=/^[/+]?[(]?[0-9]{3}[)]?[-\s/.]?[0-9]{3}[-\s/.]?[0-9]{4,6}$/im;return function(e){return e&&t.test(e)||"Must be a valid phone number"}}}},538:function(t,e,n){"use strict";n.r(e);n(9),n(6),n(8),n(11),n(12);var r=n(2),o=(n(24),n(30),n(51),n(20),n(72),n(7),n(39),n(79)),c=n.n(o),l=n(459);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var h={props:["submitForm","buttonText","hasName"],data:function(){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({ceo:!1,selectCity:"",cities:[],search:"",expanded:[],singleExpand:!1,dialog:!1,dialogDelete:!1,headers:[{text:"Name",align:"start",value:"name",groupable:!1},{text:"Category",value:"category.name",align:"right"},{text:"Price (incl. VAT)",value:"priceInclTax",align:"right"},{text:"VAT %",value:"vat",align:"right"},{text:"Price (excl. VAT)",value:"priceExclTax",align:"right"},{text:"Actions",value:"actions",sortable:!1}],id_category:-1,formdata:null,valid:!0,alergen:{id:"",name:""},products:[],allergenList:[],categoryList:[],ids:[],allergens_from_edit:[],allergen_object_from_creation:[],allergens_from_creation:[],allergens_with_select:[],ingredient:{id:"",name:"",quantity:0,unit:""},product:{id:"",name:"",allergens:[],category:{id:"",name:""},recipe:{id:"",description:"",ingredients:[]},priceInclTax:null,vat:null},productInfo:{id:"",name:"",allergens:[],selectCategory:"",priceInclTax:null,vat:null},defaultProduct:{id:"",name:"",allergens:[],category:{id:"",name:""},recipe:{id:"",description:"",ingredients:[]},priceInclTax:null,vat:null},managment:!1,checkbox:!1,editedIndex:-1},l.a)},computed:{formTitle:function(){return"Edit Item"}},watch:{dialog:function(t){t||this.close()},dialogDelete:function(t){t||this.closeDelete()}},mounted:function(){this.getAllProducts(),this.getCategories(),this.getAllergens(),this.getCities(),"CEO"===this.$auth.user.role.name&&(this.ceo=!0,this.managment=!0),"ADMIN"!==this.$auth.user.role.name&&"DEPARTMENT"!==this.$auth.user.role.name||(this.managment=!0)},methods:{getCities:function(){var t=this;c.a.get("http://212.227.210.204:8765/cities",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){t.cities=e.data})).catch((function(t){window.alert("An error occurred. Please try again!");var e=t.response;console.log(JSON.stringify(e.data.errors))}))},getAllProducts:function(){var t=this;c.a.get("http://212.227.210.204:8765/products",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){t.products=e.data})).catch((function(t){return console.log(t)}))},getCategories:function(){var t=this;c.a.get("http://212.227.210.204:8765/categories",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){t.categoryList=e.data})).catch((function(t){window.alert("An error occurred. Please try again!");var e=t.response;console.log(e)}))},getAllergens:function(){var t=this;c.a.get("http://212.227.210.204:8765/allergens",{headers:{Authorization:this.$auth.getToken("local")}}).then((function(e){t.allergenList=e.data})).catch((function(t){window.alert("An error occurred. Please try again!");var e=t.response;console.log(e)}))},findIDAllergensCreation:function(){var t=this;this.productInfo.allergens=this.productInfo.allergens.toString().split(","),this.allergenList.forEach((function(element){t.productInfo.allergens.forEach((function(e){element.name===e&&t.ids.push(element.id)}))}))},findIDCategory:function(){var t=this;this.categoryList.forEach((function(element){element.name===t.productInfo.selectCategory&&(t.id_category=element.id)})),-1===this.id_category&&console.log("no existing id")},addProduct:function(){var t=this;this.findIDAllergensCreation(),this.findIDCategory(),this.formdata=new FormData,this.formdata.append("name",this.productInfo.name),this.formdata.append("allergens",this.ids),this.formdata.append("cat_id",this.id_category),this.formdata.append("recipe_id",""),this.formdata.append("price",this.productInfo.priceInclTax),this.formdata.append("vat",this.productInfo.vat);var e=0;!0===this.ceo?(this.cities.forEach((function(n){n.name===t.selectCity&&(e=n.id)})),this.formdata.append("city",e)):this.formdata.append("city",this.$auth.user.employee.department.city.id),c()({url:"http://212.227.210.204:8765/department/create_product",method:"POST",data:this.formdata,headers:{Authorization:this.$auth.getToken("local"),"Content-Type":"multipart/form-data"}}).then((function(t){})).catch((function(t){window.alert("An error occurred. Please try again!");var e=t.response;console.log(JSON.stringify(e))})),window.location.reload()},findIDAllergens:function(){var t=this;this.productInfo.allergens=this.productInfo.allergens.toString().split(","),this.allergenList.forEach((function(element){t.productInfo.allergens.forEach((function(e){element.name===e&&t.ids.push(element.id)}))}))},getItemById:function(t){var e=this;c.a.get("http://212.227.210.204:8765/product/"+t.id,{headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){e.product=t.data})).catch((function(t){window.alert("An error occurred. Please try again!");var e=t.response;console.log(e),console.log(JSON.stringify(e.data.errors))}))},editProduct:function(t){var e=this;this.getAllergens(),this.allergens_with_select=[],this.allergenList.forEach((function(element){e.allergens_with_select.push(element)})),this.allergens_with_select.forEach((function(t){t.selected=!1}));var n=t.allergens.map((function(t){return t.name}));this.allergens_with_select.forEach((function(t){n.forEach((function(element){t.name===element&&(t.selected=!0)}))}));var r=[];this.allergens_with_select.forEach((function(element){!0===element.selected&&(e.alergen.id=element.id,e.alergen.name=element.name,r.push(e.alergen))})),t.allergens=r,this.product=t,this.selectCity=t.city.name,this.dialog=!0},save:function(){var t=this;this.ids=[],this.allergens_with_select.forEach((function(e){e.selected&&t.ids.push(e.id)})),this.categoryList.forEach((function(element){element.name===t.product.category.name&&(t.product.category.id=element.id,console.log("changed"))})),this.formdata=new FormData,this.formdata.append("id",this.product.id),this.formdata.append("name",this.product.name),this.formdata.append("allergens",this.ids),this.formdata.append("cat_id",this.product.category.id),null!==this.product.recipe?this.formdata.append("recipe_id",this.product.recipe.id):this.formdata.append("recipe_id",""),this.formdata.append("price",this.product.priceInclTax),this.formdata.append("vat",this.product.vat);var e=0;!0===this.ceo?(this.cities.forEach((function(n){n.name===t.selectCity&&(e=n.id)})),this.formdata.append("city",e)):this.formdata.append("city",this.$auth.user.employee.department.city.id),c()({url:"http://212.227.210.204:8765/department/update_product",method:"PUT",headers:{Authorization:this.$auth.getToken("local"),"Content-Type":"multipart/form-data"},data:this.formdata}).then((function(t){})).catch((function(t){console.log("in catch"),window.alert("An error occurred. Please try again!");var e=t.response;console.log(JSON.stringify(e.data.errors))})),this.products=this.getAllProducts(),this.close(),window.location.reload()},removeProduct:function(t){this.product=Object.assign(this.product,t),this.dialogDelete=!0},deleteItemConfirm:function(){c()({url:"http://212.227.210.204:8765/department/delete_product/"+this.product.id.toString(),method:"DELETE",headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){})).catch((function(t){console.log("in catch"),window.alert("An error occurred. Please try again!");var e=t.response;console.log(JSON.stringify(e.data.errors))})),this.closeDelete(),this.products=this.getAllProducts()},unlinkRecipe:function(t){c()({url:"http://212.227.210.204:8765/department/remove_recipe_from_product/"+t,method:"PUT",headers:{Authorization:this.$auth.getToken("local")}}).then((function(t){})).catch((function(t){console.log("in catch"),window.alert("An error occurred. Please try again!");var e=t.response;console.log(JSON.stringify(e.data.errors))})),window.location.reload()},close:function(){this.dialog=!1,this.resetForm()},closeDelete:function(){var t=this;this.dialogDelete=!1,this.$nextTick((function(){t.productInfo=Object.assign({},t.defaultProduct),t.editedIndex=-1})),window.location.reload()},resetForm:function(){this.$refs.form.reset()},exportpdf:function(){}}},f=n(78),m=n(96),v=n.n(m),_=n(231),y=n(455),x=n(454),I=n(474),k=n(468),$=n(453),w=n(612),T=n(475),C=n(195),A=n(460),P=n(155),V=n(196),O=n(131),D=n(70),E=n(202),L=n(467),S=n(57),j=n(451),N=n(86),F=n(64),z=n(208),component=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.products,search:t.search,"single-expand":t.singleExpand,expanded:t.expanded,"item-key":"name","show-expand":"","sort-by":"name"},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[t._v(t._s(t.$t("products")))]),t._v(" "),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t._v(" "),n("v-spacer"),t._v(" "),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:t.$t("search"),"single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[t._v(t._s(t.$t("editItem")))])]),t._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:t.$t("productName")},model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:t.$t("priceInclVAT")},model:{value:t.product.priceInclTax,callback:function(e){t.$set(t.product,"priceInclTax",e)},expression:"product.priceInclTax"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-select",{ref:"category",attrs:{items:t.categoryList.map((function(t){return t.name})),rules:[function(t){return!!t||"Item is required"}],label:t.$t("categoryName"),required:""},model:{value:t.product.category.name,callback:function(e){t.$set(t.product.category,"name",e)},expression:"product.category.name"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-menu",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({attrs:{color:"primary",dark:""}},"v-btn",o,!1),r),[t._v("\n                          "+t._s(t.$t("allergens"))+"\n                        ")])]}}])},[t._v(" "),n("v-list",t._l(t.allergens_with_select,(function(e){return n("v-list-item",{key:e.id},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"allergen.selected"}],attrs:{type:"checkbox"},domProps:{checked:e.selected,checked:Array.isArray(e.selected)?t._i(e.selected,null)>-1:e.selected},on:{change:function(n){var r=e.selected,o=n.target,c=!!o.checked;if(Array.isArray(r)){var l=t._i(r,null);o.checked?l<0&&t.$set(e,"selected",r.concat([null])):l>-1&&t.$set(e,"selected",r.slice(0,l).concat(r.slice(l+1)))}else t.$set(e,"selected",c)}}}),t._v(" "+t._s(e.name)+"\n                        ")])})),1)],1)],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:t.$t("VAT")},model:{value:t.product.vat,callback:function(e){t.$set(t.product,"vat",e)},expression:"product.vat"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t.ceo?n("v-select",{ref:"city",attrs:{items:t.cities.map((function(t){return t.name})),rules:[function(t){return!!t||"Item is required"}],label:t.$t("cityChoice"),required:""},model:{value:t.selectCity,callback:function(e){t.selectCity=e},expression:"selectCity"}}):t._e()],1)],1)],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v("\n                "+t._s(t.$t("cancel"))+"\n              ")]),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.save}},[t._v("\n                "+t._s(t.$t("save"))+"\n              ")])],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialogDelete,callback:function(e){t.dialogDelete=e},expression:"dialogDelete"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v("\n              "+t._s(t.$t("areYouSureYouWantToDeleteThisItem"))+"\n            ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.closeDelete}},[t._v("\n                "+t._s(t.$t("cancel"))+"\n              ")]),t._v(" "),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.deleteItemConfirm}},[t._v("\n                OK\n              ")]),t._v(" "),n("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function(e){var r=e.item;return[t.managment?n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(e){return t.editProduct(r)}}},[t._v("\n        mdi-pencil\n      ")]):t._e(),t._v(" "),t.managment?n("v-icon",{attrs:{small:""},on:{click:function(e){return t.removeProduct(r)}}},[t._v("\n        mdi-delete\n      ")]):t._e()]}},{key:"expanded-item",fn:function(e){var r=e.item;return[n("td",{attrs:{colspan:t.headers.length}},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",[t._v(t._s(t.$t("moreInfo")))]),t._v(" "),n("v-list-item-subtitle",[t._v("\n              "+t._s(t.$t("allergens"))+": "+t._s(r.allergens.map((function(a){return a.name})))+"\n            ")]),t._v(" "),r.recipe?n("v-list",[n("v-btn",{staticClass:"primary",attrs:{text:"",to:"/recipe/"+r.recipe.id}},[t._v("\n                "+t._s(t.$t("recipe"))+"\n              ")]),t._v(" "),t.managment?n("v-btn",{staticClass:"secondary",attrs:{text:""},on:{click:function(e){return t.unlinkRecipe(r.id)}}},[t._v("\n                "+t._s(t.$t("deleteRecipeFromProduct"))+"\n              ")]):t._e()],1):n("v-list",[n("v-text",[t._v("\n                "+t._s(t.$t("noRecipesCreatedForThisProduct"))+"\n              ")]),t._v(" "),t.managment?n("v-btn",{staticClass:"primary",attrs:{text:"",to:"/createRecipe/"+r.id}},[t._v("\n                "+t._s(t.$t("createRecipe"))+"\n              ")]):t._e()],1)],1)],1)],1)]}}],null,!0)}),t._v(" "),n("v-toolbar",{attrs:{color:"transparent",dark:""}},[t.managment?n("v-toolbar-title",[t._v("\n      "+t._s(t.$t("createNewProduct"))+"\n    ")]):t._e(),t._v(" "),n("v-spacer")],1),t._v(" "),t.managment?n("v-form",{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[n("v-text-field",{ref:"name",attrs:{label:t.$t("name"),rules:[t.required("Name")]},model:{value:t.productInfo.name,callback:function(e){t.$set(t.productInfo,"name",e)},expression:"productInfo.name"}}),t._v(" "),n("v-select",{ref:"category",attrs:{items:t.categoryList.map((function(t){return t.name})),rules:[function(t){return!!t||"Category is required"}],label:t.$t("category"),required:""},model:{value:t.productInfo.selectCategory,callback:function(e){t.$set(t.productInfo,"selectCategory",e)},expression:"productInfo.selectCategory"}}),t._v(" "),n("v-select",{ref:"allergens",attrs:{items:t.allergenList.map((function(t){return t.name})),label:t.$t("allergens"),multiple:""},model:{value:t.productInfo.allergens,callback:function(e){t.$set(t.productInfo,"allergens",e)},expression:"productInfo.allergens"}}),t._v(" "),n("v-text-field",{ref:"price",attrs:{label:t.$t("priceInclVAT"),rules:[t.required("price")]},model:{value:t.productInfo.priceInclTax,callback:function(e){t.$set(t.productInfo,"priceInclTax",e)},expression:"productInfo.priceInclTax"}}),t._v(" "),n("v-text-field",{attrs:{label:t.$t("VAT"),rules:[t.required("VAT")]},model:{value:t.productInfo.vat,callback:function(e){t.$set(t.productInfo,"vat",e)},expression:"productInfo.vat"}}),t._v(" "),t.ceo?n("v-select",{ref:"city",attrs:{items:t.cities.map((function(t){return t.name})),rules:[function(t){return!!t||"Item is required"}],label:t.$t("cityChoice"),required:""},model:{value:t.selectCity,callback:function(e){t.selectCity=e},expression:"selectCity"}}):t._e(),t._v(" "),n("v-checkbox",{attrs:{rules:[function(t){return!!t||"You must agree to continue!"}],label:t.$t("isInformationCorrect"),required:""},model:{value:t.checkbox,callback:function(e){t.checkbox=e},expression:"checkbox"}}),t._v(" "),n("v-btn",{attrs:{color:"success",disabled:!t.valid},on:{click:function(e){return t.addProduct()}}},[t._v("\n      "+t._s(t.$t("submit"))+" "+t._s(t.buttonText)+"\n    ")]),t._v(" "),n("v-btn",{attrs:{color:"error"},on:{click:function(e){return t.resetForm()}}},[t._v("\n      "+t._s(t.$t("resetForm"))+" "+t._s(t.buttonText)+"\n    ")])],1):t._e()],1)}),[],!1,null,"c92a9090",null);e.default=component.exports;v()(component,{VBtn:_.a,VCard:y.a,VCardActions:x.a,VCardText:x.b,VCardTitle:x.c,VCheckbox:I.a,VCol:k.a,VContainer:$.a,VDataTable:w.a,VDialog:T.a,VDivider:C.a,VForm:A.a,VIcon:P.a,VList:V.a,VListItem:O.a,VListItemContent:D.a,VListItemSubtitle:D.b,VListItemTitle:D.c,VMenu:E.a,VRow:L.a,VSelect:S.a,VSpacer:j.a,VTextField:N.a,VToolbar:F.a,VToolbarTitle:z.a})},625:function(t,e,n){"use strict";n.r(e);var r={components:{ProductsListing:n(538).default},mounted:function(){!1===this.$auth.loggedIn&&(window.location="/login")}},o=n(78),c=n(96),l=n.n(c),d=n(453),component=Object(o.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",[e("ProductsListing")],1)}),[],!1,null,null,null);e.default=component.exports;l()(component,{VContainer:d.a})}}]);